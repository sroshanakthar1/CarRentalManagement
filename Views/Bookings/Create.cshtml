@model CarRentalManagement.ViewModels.BookingViewModel

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow-sm border-0">
                <div class="card-header bg-warning text-white text-center">
                    <h3>Booking Page</h3>
                </div>
                <div class="card-body">

                    <div class="d-flex justify-content-center mb-3">
                        <img src="@Model.CarImageUrl" class="img-fluid rounded" style="max-height:200px;" />
                    </div>

                    <h5 class="card-title text-center">@Model.CarName (@Model.CarModel)</h5>
                    <p>Transmission: <strong>@Model.Transmission</strong></p>
                    <p>Seats: <strong>@Model.SeatingCapacity</strong></p>
                    <p>Fuel: <strong>@Model.FuelType</strong></p>
                    <p class="fw-bold text-warning">Price/Day: @Model.CarPrice.ToString("C")</p>

                    @if (!string.IsNullOrEmpty(Model.Error))
                    {
                        <div class="alert alert-danger">@Model.Error</div>
                    }

                    <form asp-action="ConfirmBooking" method="post">
                        <input type="hidden" asp-for="CarID" />
                        <input type="hidden" asp-for="TotalCost" />
                        <input type="hidden" asp-for="PickupDate" />
                        <input type="hidden" asp-for="ReturnDate" />

                        <div class="mb-3">
                            <label for="pickupDate" class="form-label">Pickup Date</label>
                            <input type="date" id="pickupDate" name="PickupDate" class="form-control"
                                   value="@Model.PickupDate.ToString("yyyy-MM-dd")" required />
                        </div>

                        <div class="mb-3">
                            <label for="returnDate" class="form-label">Return Date</label>
                            <input type="date" id="returnDate" name="ReturnDate" class="form-control"
                                   value="@Model.ReturnDate.ToString("yyyy-MM-dd")" required />
                        </div>

                        <div class="mb-3">
                            <label for="totalCostDisplay" class="form-label">Total Cost</label>
                            <input type="text" id="totalCostDisplay" value="@Model.TotalCost.ToString("F2")"
                                   class="form-control text-success fw-bold" readonly />
                        </div>
                        <a asp-controller="User" asp-action="Login" class="btn btn-warning w-100 text-white">
                            PaymentProcess
                        </a>

                    </form>
                       
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        const pricePerDay = @Model.CarPrice;

        function calculateTotalCost() {
            const pickup = new Date(document.getElementById("pickupDate").value);
            const ret = new Date(document.getElementById("returnDate").value);
            const days = (ret - pickup) / (1000 * 60 * 60 * 24);

            if (days > 0) {
                document.getElementById("totalCostDisplay").value =
                    (days * pricePerDay).toLocaleString('en-IN', { style: 'currency', currency: 'INR' });
            } else {
                document.getElementById("totalCostDisplay").value = "Invalid dates";
            }
        }

        document.getElementById("pickupDate").addEventListener("change", calculateTotalCost);
        document.getElementById("returnDate").addEventListener("change", calculateTotalCost);
        calculateTotalCost();
    </script>
}

